# 版本管理功能演示

## 🎯 功能演示步骤

### 1. 启动应用
访问 http://localhost:3004 (或其他可用端口)

### 2. 创建测试文件
1. 点击 "新建文件" 按钮
2. 输入文件名：`test.tex`
3. 在编辑器中输入以下内容：

```latex
\documentclass{article}
\usepackage[utf8]{inputenc}
\title{测试文档}
\author{用户}
\date{\today}

\begin{document}
\maketitle

\section{介绍}
这是一个测试文档。

\end{document}
```

### 3. 测试版本管理功能

#### 创建第一个快照
1. 点击工具栏的 "版本管理" 按钮 (或按 Ctrl+Shift+V)
2. 点击 "创建快照" 按钮
3. 输入描述："初始版本"
4. 确认创建

#### 修改文档内容
在编辑器中添加新的章节：

```latex
\section{新章节}
这是新添加的内容。

\subsection{子章节}
更多详细内容。
```

#### 创建第二个快照
1. 再次打开版本管理
2. 创建新快照，描述："添加新章节"

#### 继续修改
修改介绍部分：

```latex
\section{介绍}
这是一个测试文档，用于演示版本管理功能。
我们可以看到版本控制的强大功能。
```

#### 创建第三个快照
描述："更新介绍内容"

### 4. 测试版本比较

#### 比较版本
1. 在版本管理界面中，勾选第一个和第三个版本
2. 点击 "比较版本" 按钮
3. 查看差异显示：
   - 绿色：新增的行
   - 红色：删除的行
   - 白色：未修改的行

#### 查看统计
比较窗口会显示：
- 添加的行数
- 删除的行数
- 版本信息对比

### 5. 测试版本恢复

#### 恢复到历史版本
1. 选择第一个版本
2. 点击 "恢复" 按钮
3. 确认恢复操作
4. 观察编辑器内容回到初始状态

#### 查看版本历史
1. 点击任意版本的 "查看" 按钮
2. 在弹出窗口中查看完整内容

### 6. 测试自动快照

#### 设置自动快照
1. 点击 "自动快照" 按钮
2. 设置间隔为 1 分钟
3. 修改文档内容
4. 等待 1 分钟，观察是否自动创建快照

### 7. 测试数据导出

#### 导出版本历史
1. 点击 "导出历史" 按钮
2. 下载 JSON 文件
3. 查看文件内容，包含所有版本数据

## 🔍 预期效果

### 版本管理界面
- 显示版本统计（总版本数、字符数、最后修改时间）
- 版本列表按时间倒序排列
- 最新版本有 "最新" 标记
- 每个版本显示版本号、时间、描述、大小

### 版本比较界面
- 并排显示两个版本的信息
- 统计显示添加/删除的行数
- 差异内容用颜色区分
- 行号和前缀符号清晰显示

### 快照查看器
- 显示快照的详细信息
- 完整的文档内容
- 只读模式，不可编辑

### 通知系统
- 快照创建成功提示
- 版本恢复成功提示
- 快照删除确认提示
- 错误和警告信息

## 🛠️ 技术验证

### Yjs 集成验证
- 打开浏览器开发者工具
- 查看 Console 输出，应该看到：
  ```
  为文件 test.tex 创建了 Y.Doc
  为文件 test.tex 绑定了 Monaco 编辑器
  版本管理器初始化完成
  ```

### IndexedDB 存储验证
- 在开发者工具的 Application 标签页
- 查看 IndexedDB，应该看到 Yjs 相关的数据库
- 查看 localStorage，应该看到 `yjs-snapshots` 键

### 快捷键验证
- `Ctrl+Shift+V` 打开版本管理
- `Ctrl+Shift+S` 快速创建快照

## 🐛 故障排除

### 常见问题
1. **版本管理按钮不响应**
   - 检查控制台是否有 JavaScript 错误
   - 确认文件已正确加载

2. **快照创建失败**
   - 检查浏览器存储权限
   - 清理浏览器缓存重试

3. **版本比较显示异常**
   - 确认选择了两个不同的版本
   - 检查版本数据是否完整

4. **自动快照不工作**
   - 确认设置了正确的时间间隔
   - 检查页面是否保持活跃状态

### 调试信息
在控制台中可以查看详细的调试信息：
- 版本管理器的初始化过程
- 快照的创建和恢复操作
- Yjs 文档的状态变化
- 错误和警告信息

## 📈 性能测试

### 大文件测试
1. 创建包含 1000+ 行的大型 LaTeX 文档
2. 测试快照创建速度
3. 测试版本比较性能
4. 观察内存使用情况

### 多版本测试
1. 创建 20+ 个版本快照
2. 测试版本列表加载速度
3. 测试版本切换响应时间
4. 验证存储空间使用

 